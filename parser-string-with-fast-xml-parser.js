// https://github.com/NaturalIntelligence/fast-xml-parser/blob/HEAD/docs/v4/2.XMLparseOptions.md

const { XMLParser } = require('fast-xml-parser');
const fs = require('fs');

// var argv = require('yargs/yargs')(process.argv.slice(2))
//     .usage('Usage: node $0 -f [filepath] ')
//     .example('node $0 -f /home/foo.xml', 'converts the /home/foo.xml to json and output is written in file ./parser-output.json')
//     .nargs('f', 1)
//     .alias('f', 'file')
//     .describe('f', 'parses an xml file and converts to json')
//     .demandOption(['f'])
//     .strict()
//     .argv;

// if (!argv.f || argv.f === "")
//     console

// const alwaysArray = [
//     "root.a.c",
//     "root.b"
// ];

const options = {
    ignoreAttributes: false,
    attributeNamePrefix: "@_",
    attributesGroupName: "attributes@_",
    allowBooleanAttributes: true,
    alwaysCreateTextNode: false,
    cdataPropName: "__cdata",
    ignoreDeclaration: false,
    ignorePiTags: false,
    textNodeName: "$text"
    // isArray: (name, jpath, isLeafNode, isAttribute) => {  //force tags which are array
    //     if( alwaysArray.indexOf(jpath) !== -1) return true;
    // }
    // stopNodes: ["root.a"] //stop parser from parsing tags nested tags
    //unpairedTags: ["unpaired"] //specifying which tags should be treated as unpaired i.e. <br >


};

const parser = new XMLParser(options);


const src = {"type":"Buffer","data":[60,63,120,109,108,32,118,101,114,115,105,111,110,61,34,49,46,48,34,32,101,110,99,111,100,105,110,103,61,34,85,84,70,45,56,34,63,62,10,60,68,111,99,117,109,101,110,116,32,120,109,108,110,115,61,34,117,114,110,58,105,115,111,58,115,116,100,58,105,115,111,58,50,48,48,50,50,58,116,101,99,104,58,120,115,100,58,99,97,109,116,46,48,53,50,46,48,48,49,46,48,50,34,32,120,109,108,110,115,58,120,115,105,61,34,104,116,116,112,58,47,47,119,119,119,46,119,51,46,111,114,103,47,50,48,48,49,47,88,77,76,83,99,104,101,109,97,45,105,110,115,116,97,110,99,101,34,32,120,115,105,58,115,99,104,101,109,97,76,111,99,97,116,105,111,110,61,34,117,114,110,58,105,115,111,58,115,116,100,58,105,115,111,58,50,48,48,50,50,58,116,101,99,104,58,120,115,100,58,99,97,109,116,46,48,53,50,46,48,48,49,46,48,50,32,102,105,108,101,58,47,47,47,67,58,47,85,115,101,114,115,47,115,57,48,50,53,49,47,68,101,115,107,116,111,112,47,102,105,108,101,115,47,84,101,109,112,108,97,116,101,47,99,97,109,116,46,48,53,50,46,48,48,49,46,48,50,46,120,115,100,34,62,10,9,60,66,107,84,111,67,115,116,109,114,65,99,99,116,82,112,116,62,10,9,9,60,71,114,112,72,100,114,62,10,9,9,9,60,77,115,103,73,100,62,50,57,55,49,50,50,50,60,47,77,115,103,73,100,62,10,9,9,9,60,67,114,101,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,54,58,51,51,58,50,48,90,60,47,67,114,101,68,116,84,109,62,10,9,9,9,60,77,115,103,82,99,112,116,62,10,9,9,9,9,60,73,100,62,10,9,9,9,9,9,60,79,114,103,73,100,62,10,9,9,9,9,9,9,60,79,116,104,114,62,10,9,9,9,9,9,9,9,60,73,100,62,48,48,51,51,49,49,50,55,56,48,48,48,48,53,60,47,73,100,62,10,9,9,9,9,9,9,9,60,83,99,104,109,101,78,109,62,10,9,9,9,9,9,9,9,9,60,67,100,62,66,65,78,75,60,47,67,100,62,10,9,9,9,9,9,9,9,60,47,83,99,104,109,101,78,109,62,10,9,9,9,9,9,9,60,47,79,116,104,114,62,10,9,9,9,9,9,60,47,79,114,103,73,100,62,10,9,9,9,9,60,47,73,100,62,10,9,9,9,60,47,77,115,103,82,99,112,116,62,10,9,9,9,60,65,100,100,116,108,73,110,102,62,47,66,65,76,78,47,60,47,65,100,100,116,108,73,110,102,62,10,9,9,60,47,71,114,112,72,100,114,62,10,9,9,60,82,112,116,62,10,9,9,9,60,73,100,62,83,84,79,73,73,68,50,53,49,56,49,49,50,48,49,55,51,49,52,50,48,48,48,48,48,54,60,47,73,100,62,10,9,9,9,60,69,108,99,116,114,110,99,83,101,113,78,98,62,52,52,53,55,60,47,69,108,99,116,114,110,99,83,101,113,78,98,62,10,9,9,9,60,76,103,108,83,101,113,78,98,62,52,52,53,55,60,47,76,103,108,83,101,113,78,98,62,10,9,9,9,60,67,114,101,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,50,58,53,53,58,49,49,43,48,49,58,48,48,60,47,67,114,101,68,116,84,109,62,10,9,9,9,60,65,99,99,116,62,10,9,9,9,9,60,73,100,62,10,9,9,9,9,9,60,79,116,104,114,62,10,9,9,9,9,9,9,60,73,100,62,53,50,57,53,48,48,48,49,54,57,49,49,52,55,60,47,73,100,62,10,9,9,9,9,9,9,60,83,99,104,109,101,78,109,62,10,9,9,9,9,9,9,9,60,67,100,62,66,66,65,78,60,47,67,100,62,10,9,9,9,9,9,9,60,47,83,99,104,109,101,78,109,62,10,9,9,9,9,9,60,47,79,116,104,114,62,10,9,9,9,9,60,47,73,100,62,10,9,9,9,9,60,67,99,121,62,68,75,75,60,47,67,99,121,62,10,9,9,9,9,60,79,119,110,114,62,10,9,9,9,9,9,60,78,109,62,84,69,83,84,32,67,117,115,116,111,109,101,114,60,47,78,109,62,10,9,9,9,9,9,60,73,100,62,10,9,9,9,9,9,9,60,79,114,103,73,100,62,10,9,9,9,9,9,9,9,60,79,116,104,114,62,10,9,9,9,9,9,9,9,9,60,73,100,62,48,48,51,51,49,49,50,55,56,48,48,48,48,53,60,47,73,100,62,10,9,9,9,9,9,9,9,9,60,83,99,104,109,101,78,109,62,10,9,9,9,9,9,9,9,9,9,60,67,100,62,66,65,78,75,60,47,67,100,62,10,9,9,9,9,9,9,9,9,60,47,83,99,104,109,101,78,109,62,10,9,9,9,9,9,9,9,60,47,79,116,104,114,62,10,9,9,9,9,9,9,60,47,79,114,103,73,100,62,10,9,9,9,9,9,60,47,73,100,62,10,9,9,9,9,60,47,79,119,110,114,62,10,9,9,9,9,60,83,118,99,114,62,10,9,9,9,9,9,60,70,105,110,73,110,115,116,110,73,100,62,10,9,9,9,9,9,9,60,66,73,67,62,69,83,83,69,68,75,75,75,88,88,88,60,47,66,73,67,62,10,9,9,9,9,9,60,47,70,105,110,73,110,115,116,110,73,100,62,10,9,9,9,9,60,47,83,118,99,114,62,10,9,9,9,60,47,65,99,99,116,62,10,9,9,9,60,66,97,108,62,10,9,9,9,9,60,84,112,62,10,9,9,9,9,9,60,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,9,60,67,100,62,67,76,66,68,60,47,67,100,62,10,9,9,9,9,9,60,47,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,60,83,117,98,84,112,62,10,9,9,9,9,9,9,60,67,100,62,73,78,84,77,60,47,67,100,62,10,9,9,9,9,9,60,47,83,117,98,84,112,62,10,9,9,9,9,60,47,84,112,62,10,9,9,9,9,60,67,100,116,76,105,110,101,62,10,9,9,9,9,9,60,73,110,99,108,62,102,97,108,115,101,60,47,73,110,99,108,62,10,9,9,9,9,60,47,67,100,116,76,105,110,101,62,10,9,9,9,9,60,65,109,116,32,67,99,121,61,34,68,75,75,34,62,48,46,48,48,60,47,65,109,116,62,10,9,9,9,9,60,67,100,116,68,98,116,73,110,100,62,67,82,68,84,60,47,67,100,116,68,98,116,73,110,100,62,10,9,9,9,9,60,68,116,62,10,9,9,9,9,9,60,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,50,58,53,53,58,49,49,43,48,49,58,48,48,60,47,68,116,84,109,62,10,9,9,9,9,60,47,68,116,62,10,9,9,9,60,47,66,97,108,62,10,9,9,9,60,66,97,108,62,10,9,9,9,9,60,84,112,62,10,9,9,9,9,9,60,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,9,60,67,100,62,79,80,66,68,60,47,67,100,62,10,9,9,9,9,9,60,47,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,60,83,117,98,84,112,62,10,9,9,9,9,9,9,60,67,100,62,73,78,84,77,60,47,67,100,62,10,9,9,9,9,9,60,47,83,117,98,84,112,62,10,9,9,9,9,60,47,84,112,62,10,9,9,9,9,60,67,100,116,76,105,110,101,62,10,9,9,9,9,9,60,73,110,99,108,62,102,97,108,115,101,60,47,73,110,99,108,62,10,9,9,9,9,60,47,67,100,116,76,105,110,101,62,10,9,9,9,9,60,65,109,116,32,67,99,121,61,34,68,75,75,34,62,48,46,48,48,60,47,65,109,116,62,10,9,9,9,9,60,67,100,116,68,98,116,73,110,100,62,67,82,68,84,60,47,67,100,116,68,98,116,73,110,100,62,10,9,9,9,9,60,68,116,62,10,9,9,9,9,9,60,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,50,58,53,53,58,49,49,43,48,49,58,48,48,60,47,68,116,84,109,62,10,9,9,9,9,60,47,68,116,62,10,9,9,9,60,47,66,97,108,62,10,9,9,9,60,66,97,108,62,10,9,9,9,9,60,84,112,62,10,9,9,9,9,9,60,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,9,60,67,100,62,80,82,67,68,60,47,67,100,62,10,9,9,9,9,9,60,47,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,60,83,117,98,84,112,62,10,9,9,9,9,9,9,60,67,100,62,73,78,84,77,60,47,67,100,62,10,9,9,9,9,9,60,47,83,117,98,84,112,62,10,9,9,9,9,60,47,84,112,62,10,9,9,9,9,60,67,100,116,76,105,110,101,62,10,9,9,9,9,9,60,73,110,99,108,62,102,97,108,115,101,60,47,73,110,99,108,62,10,9,9,9,9,60,47,67,100,116,76,105,110,101,62,10,9,9,9,9,60,65,109,116,32,67,99,121,61,34,68,75,75,34,62,48,46,48,48,60,47,65,109,116,62,10,9,9,9,9,60,67,100,116,68,98,116,73,110,100,62,67,82,68,84,60,47,67,100,116,68,98,116,73,110,100,62,10,9,9,9,9,60,68,116,62,10,9,9,9,9,9,60,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,50,58,53,53,58,49,49,43,48,49,58,48,48,60,47,68,116,84,109,62,10,9,9,9,9,60,47,68,116,62,10,9,9,9,60,47,66,97,108,62,10,9,9,9,60,66,97,108,62,10,9,9,9,9,60,84,112,62,10,9,9,9,9,9,60,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,9,60,67,100,62,67,76,65,86,60,47,67,100,62,10,9,9,9,9,9,60,47,67,100,79,114,80,114,116,114,121,62,10,9,9,9,9,9,60,83,117,98,84,112,62,10,9,9,9,9,9,9,60,67,100,62,73,78,84,77,60,47,67,100,62,10,9,9,9,9,9,60,47,83,117,98,84,112,62,10,9,9,9,9,60,47,84,112,62,10,9,9,9,9,60,67,100,116,76,105,110,101,62,10,9,9,9,9,9,60,73,110,99,108,62,102,97,108,115,101,60,47,73,110,99,108,62,10,9,9,9,9,60,47,67,100,116,76,105,110,101,62,10,9,9,9,9,60,65,109,116,32,67,99,121,61,34,68,75,75,34,62,48,46,48,48,60,47,65,109,116,62,10,9,9,9,9,60,67,100,116,68,98,116,73,110,100,62,67,82,68,84,60,47,67,100,116,68,98,116,73,110,100,62,10,9,9,9,9,60,68,116,62,10,9,9,9,9,9,60,68,116,84,109,62,50,48,49,56,45,49,49,45,50,48,84,49,50,58,53,53,58,49,49,43,48,49,58,48,48,60,47,68,116,84,109,62,10,9,9,9,9,60,47,68,116,62,10,9,9,9,60,47,66,97,108,62,10,9,9,60,47,82,112,116,62,10,9,60,47,66,107,84,111,67,115,116,109,114,65,99,99,116,82,112,116,62,10,60,47,68,111,99,117,109,101,110,116,62,10]}


const data = Buffer.from(src)
console.log("buffer data ->", data.toString());


let jsonObj = parser.parse(data);
console.log("to json ->", JSON.stringify(jsonObj, null, '\t'));
fs.writeFile('./parser-output.json', JSON.stringify(jsonObj, null, '\t'), function (err, d) {
    if (err) {
        return console.log(err);
    }
});




